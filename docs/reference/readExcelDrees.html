<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fonction extrayant le contenu de tous les onglets d'un fichier Excel diffusé sur data.drees — readExcelDrees • asdep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fonction extrayant le contenu de tous les onglets d'un fichier Excel diffusé sur data.drees — readExcelDrees" />
<meta property="og:description" content="Cette fonction sert à extraire le contenu de tous les onglets d'un fichier Excel de données départementales diffusé sous data.Drees.
Le produit est une liste contenant un élément &quot;tab&quot; correspondant au tableau de données,
et un élément &quot;metadonnees&quot; correspondant au tableau des métadonnées (source,note,champ, etc.)
Si le tableau &quot;tab&quot; contient des colonnes dont les intitulés correspondent à des années,
un autre élément &quot;tablong&quot; est disponible, dans lequel les années sont transposées en ligne plutôt qu'en colonnes." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">asdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0.0005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/comment-utiliser-asdep.html">comment-utiliser-asdep</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fonction extrayant le contenu de tous les onglets d'un fichier Excel diffusé sur data.drees</h1>
    
    <div class="hidden name"><code>readExcelDrees.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cette fonction sert à extraire le contenu de tous les onglets d'un fichier Excel de données départementales diffusé sous data.Drees.
Le produit est une liste contenant un élément "tab" correspondant au tableau de données,
et un élément "metadonnees" correspondant au tableau des métadonnées (source,note,champ, etc.)
Si le tableau "tab" contient des colonnes dont les intitulés correspondent à des années,
un autre élément "tablong" est disponible, dans lequel les années sont transposées en ligne plutôt qu'en colonnes.</p>
    </div>

    <pre class="usage"><span class='fu'>readExcelDrees</span><span class='op'>(</span>
  <span class='va'>fich</span>,
  sheetinclude <span class='op'>=</span> <span class='cn'>NULL</span>,
  sheetexclude <span class='op'>=</span> <span class='cn'>NULL</span>,
  nlignetitre <span class='op'>=</span> <span class='cn'>NULL</span>,
  options <span class='op'>=</span> <span class='st'>""</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fich</th>
      <td><p>nom du fichier Excel</p></td>
    </tr>
    <tr>
      <th>sheetinclude</th>
      <td><p>vecteur des noms des onglets à inclure dans l'extraction (par défaut : tous les onglets)</p></td>
    </tr>
    <tr>
      <th>sheetexclude</th>
      <td><p>vecteur des noms des onglets à exclure de l'extraction (par défaut : aucun onglet)</p></td>
    </tr>
    <tr>
      <th>nlignetitre</th>
      <td><p>nombre de lignes pour les intitulés de colonne dans le fichier excel</p></td>
    </tr>
    <tr>
      <th>options</th>
      <td><p>type de fichier data.drees particulier ("ASDEPslbenef", "ASDEPsldepenses", "OARSAsl", etc.)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>La fonction inclut des traitements complémentaires de mise en forme pour certains fichiers Excel
particuliers ('options' = "ASDEPslbenef", "ASDEPsldepenses", "OARSAsl", etc.)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>readExcelDrees</span><span class='op'>(</span>fich<span class='op'>=</span><span class='st'>"data-raw/Les bÃ©nÃ©ficiaires de l aide sociale dÃ©partementale - sÃ©ries longues (1996-2018).xlsx"</span>,options <span class='op'>=</span> <span class='st'>"ASDEPslbenef"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in getSheetNames(fich): impossible de trouver la fonction "getSheetNames"</span></div><div class='input'><span class='fu'>readExcelDrees</span><span class='op'>(</span>fich<span class='op'>=</span><span class='st'>"data-raw/Le personnel dÃ©partemental de l'action sociale et mÃ©dico-sociale de 2014 Ã  2018.xlsx"</span>,options <span class='op'>=</span> <span class='st'>"ASDEPslperso"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in getSheetNames(fich): impossible de trouver la fonction "getSheetNames"</span></div><div class='input'><span class='fu'>readExcelDrees</span><span class='op'>(</span>fich<span class='op'>=</span><span class='st'>"data-raw/Les dÃ©penses d aide sociale dÃ©partementale - sÃ©ries longues (1999 -2018).xlsx"</span>,options <span class='op'>=</span> <span class='st'>"ASDEPsldepenses"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in getSheetNames(fich): impossible de trouver la fonction "getSheetNames"</span></div><div class='input'><span class='fu'>readExcelDrees</span><span class='op'>(</span>fich<span class='op'>=</span><span class='st'>"data-raw/DonnÃ©es mensuelles des prestations de solidaritÃ©.xlsx"</span>,options <span class='op'>=</span> <span class='st'>"PrestaSolMens"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in getSheetNames(fich): impossible de trouver la fonction "getSheetNames"</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Patrick Aubert.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


